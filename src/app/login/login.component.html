<div class="login-page">
  <div class="left-side">
    <div class="logo-container">
      <img src="/assets/images/login.png" alt="Logo" class="logo" />
    </div>
  </div>
  <div class="right-side">
    <div class="login-content">
      <!-- Regular login form -->
      <div *ngIf="!showTwoFactorAuth">
        <h1 class="title">Welcome to RE</h1>

        <button
          nz-button
          nzType="default"
          class="ms-button"
          (click)="loginWithMicrosoft()"
        >
          Sign in with Microsoft
        </button>

        <div class="separator">
          <span>or sign in with</span>
        </div>
        <form nz-form (ngSubmit)="onSubmit()">
          <nz-form-item>
            <nz-form-label [nzSpan]="24" nzFor="username">Username</nz-form-label>
            <nz-form-control [nzSpan]="24">
              <input
                nz-input
                id="username"
                name="username"
                type="text"
                placeholder="Username"
                [(ngModel)]="username"
                required
              />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label [nzSpan]="24" nzFor="password">Password</nz-form-label>
            <nz-form-control [nzSpan]="24">
              <input
                nz-input
                id="password"
                name="password"
                type="password"
                placeholder="Password"
                [(ngModel)]="password"
                required
              />
            </nz-form-control>
          </nz-form-item>

          <button
            nz-button
            nzType="primary"
            class="signin-btn"
            style="width: 100%; margin-top: 16px; font-weight: normal"
            type="submit"
          >
            Sign In
          </button>
        </form>
      </div>

      <!-- 2FA -->
      <div *ngIf="showTwoFactorAuth">
        <h1 class="title">Enter the 6-digit verification code</h1>
        
        <!-- QR CODE -->
        <div *ngIf="!isTwoFactorSetup" class="tfa-setup">
          <p>Please scan this QR code with your authenticator app:</p>
          <div class="qr-container">
            <img [src]="'https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=' + otpauthUrl" alt="QR Code" />
          </div>
        </div>

        <form nz-form (ngSubmit)="submitTwoFactorCode()">
          <nz-form-item>
            
            <nz-form-control [nzSpan]="24">
              <input
                nz-input
                id="twoFactorCode"
                name="twoFactorCode"
                type="text"
                placeholder="123456"
                [(ngModel)]="twoFactorCode"
                required
                maxlength="6"
                pattern="[0-9]*"
              />
            </nz-form-control>
          </nz-form-item>

          <button
            nz-button
            nzType="primary"
            class="signin-btn"
            style="width: 100%; margin-top: 16px; font-weight: normal;"
            type="submit"
          >
            SIGN IN
          </button>

          <button
            nz-button
            nzType="default"
            class="back-btn"
            style="width: 100%; margin-top: 16px;"
            (click)="backToLogin()"
          >
            Back to Login
          </button>
        </form>
      </div>

      <!-- Error message display -->
      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>
    </div>
  </div>
</div>